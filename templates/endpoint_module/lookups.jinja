{# BEGIN: manual mapping of parameters to lookup operations #}
{% set lookup_map = {
    "server_id": "server list",
} %}
{% set entity_map = {
    "server list": {"id": "id", "ref": "name"},
} %}
{% for parameter_name in lookup_map %}
{% for param in (endpoint.data.parameters or []) if param.param_in == "path" and param.name == parameter_name %}
{% set _ = param.__setattr__("x-cli-lookup", lookup_map[parameter_name]) %}
{% endfor %}
{% endfor %}
{% for command_name in entity_map %}
{% if endpoint.data["x-cli-command"] == command_name %}
{% set _ = endpoint.data.__setattr__("x-cli-entity", entity_map[command_name]) %}
{% endif %}
{% endfor %}
{# ENDOF: manual mapping of parameters to lookup operations #}

{# Create a dictionary of path parameter -> endpoint (defined in endpoint_module.py.jinja due to jinja scope behaviour) #}
{% for property in endpoint.path_parameters.values() %}
{% for param in endpoint.data.parameters if param.param_in == 'path' and property.name == param.name and param['x-cli-lookup'] %}
{% set lookup_endpoint = openapi.endpoints_by_name.get(param['x-cli-lookup']) %}
{% if not lookup_endpoint %}
{{ fail('lookup command not found', param['x-cli-lookup']) }}
{% endif %}
{% set _ = lookup_parameters.__setitem__(property.name, lookup_endpoint) %}
{% endfor %}
{% endfor %}
